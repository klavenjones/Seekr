{"ast":null,"code":"import NextAuth from 'next-auth';\nimport { session } from 'next-auth/client';\nimport Providers from 'next-auth/providers';\n\nconst AWS = require('aws-sdk');\n\nconst docClient = new AWS.DynamoDB.DocumentClient({\n  region: process.env.NEXT_PUBLIC_AWS_REGION,\n  accessKeyId: process.env.NEXT_PUBLIC_AWS_ACCESS_KEY_ID,\n  secretAccessKey: process.env.NEXT_PUBLIC_AWS_SECRET_ACCESS_KEY\n});\nexport default NextAuth({\n  // Configure one or more authentication providers\n  providers: [Providers.Auth0({\n    clientId: process.env.NEXT_PUBLIC_AUTH0_CLIENT_ID,\n    clientSecret: process.env.NEXT_PUBLIC_AUTH0_CLIENT_SECRET,\n    domain: process.env.NEXT_PUBLIC_AUTH0_DOMAIN\n  })],\n  session: {\n    jwt: true,\n    maxAge: 1 * 60 * 60\n  },\n  callbacks: {\n    async session(user, session) {\n      console.log('SESSION');\n      return session;\n    },\n\n    async signIn(user, account, profile) {\n      try {\n        let params = {\n          TableName: process.env.NEXT_PUBLIC_DYNAMODB_TABLE,\n          Key: {\n            userId: user.id\n          }\n        };\n        const currentUser = await docClient.get(params).promise();\n\n        if (Object.keys(currentUser).length <= 0) {\n          let newUser = {\n            TableName: process.env.NEXT_PUBLIC_DYNAMODB_TABLE,\n            Item: {\n              userId: user.id,\n              name: profile.name,\n              email: user.email,\n              image: user.image\n            }\n          };\n          await docClient.put(newUser).promise();\n        }\n      } catch (error) {\n        console.log(error.message);\n      }\n\n      return true;\n    }\n\n  }\n});","map":{"version":3,"sources":["/Users/klay/Documents/Seekr/client/pages/api/auth/[...nextauth].js"],"names":["NextAuth","session","Providers","AWS","require","docClient","DynamoDB","DocumentClient","region","process","env","NEXT_PUBLIC_AWS_REGION","accessKeyId","NEXT_PUBLIC_AWS_ACCESS_KEY_ID","secretAccessKey","NEXT_PUBLIC_AWS_SECRET_ACCESS_KEY","providers","Auth0","clientId","NEXT_PUBLIC_AUTH0_CLIENT_ID","clientSecret","NEXT_PUBLIC_AUTH0_CLIENT_SECRET","domain","NEXT_PUBLIC_AUTH0_DOMAIN","jwt","maxAge","callbacks","user","console","log","signIn","account","profile","params","TableName","NEXT_PUBLIC_DYNAMODB_TABLE","Key","userId","id","currentUser","get","promise","Object","keys","length","newUser","Item","name","email","image","put","error","message"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,WAArB;AACA,SAASC,OAAT,QAAwB,kBAAxB;AACA,OAAOC,SAAP,MAAsB,qBAAtB;;AACA,MAAMC,GAAG,GAAGC,OAAO,CAAC,SAAD,CAAnB;;AAEA,MAAMC,SAAS,GAAG,IAAIF,GAAG,CAACG,QAAJ,CAAaC,cAAjB,CAAgC;AAChDC,EAAAA,MAAM,EAAEC,OAAO,CAACC,GAAR,CAAYC,sBAD4B;AAEhDC,EAAAA,WAAW,EAAEH,OAAO,CAACC,GAAR,CAAYG,6BAFuB;AAGhDC,EAAAA,eAAe,EAAEL,OAAO,CAACC,GAAR,CAAYK;AAHmB,CAAhC,CAAlB;AAMA,eAAef,QAAQ,CAAC;AACtB;AACAgB,EAAAA,SAAS,EAAE,CACTd,SAAS,CAACe,KAAV,CAAgB;AACdC,IAAAA,QAAQ,EAAET,OAAO,CAACC,GAAR,CAAYS,2BADR;AAEdC,IAAAA,YAAY,EAAEX,OAAO,CAACC,GAAR,CAAYW,+BAFZ;AAGdC,IAAAA,MAAM,EAAEb,OAAO,CAACC,GAAR,CAAYa;AAHN,GAAhB,CADS,CAFW;AAStBtB,EAAAA,OAAO,EAAE;AACPuB,IAAAA,GAAG,EAAE,IADE;AAEPC,IAAAA,MAAM,EAAE,IAAI,EAAJ,GAAS;AAFV,GATa;AAatBC,EAAAA,SAAS,EAAE;AACT,UAAMzB,OAAN,CAAc0B,IAAd,EAAoB1B,OAApB,EAA6B;AAC3B2B,MAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ;AACA,aAAO5B,OAAP;AACD,KAJQ;;AAKT,UAAM6B,MAAN,CAAaH,IAAb,EAAmBI,OAAnB,EAA4BC,OAA5B,EAAqC;AACnC,UAAI;AACF,YAAIC,MAAM,GAAG;AACXC,UAAAA,SAAS,EAAEzB,OAAO,CAACC,GAAR,CAAYyB,0BADZ;AAEXC,UAAAA,GAAG,EAAE;AAAEC,YAAAA,MAAM,EAAEV,IAAI,CAACW;AAAf;AAFM,SAAb;AAIA,cAAMC,WAAW,GAAG,MAAMlC,SAAS,CAACmC,GAAV,CAAcP,MAAd,EAAsBQ,OAAtB,EAA1B;;AAEA,YAAIC,MAAM,CAACC,IAAP,CAAYJ,WAAZ,EAAyBK,MAAzB,IAAmC,CAAvC,EAA0C;AACxC,cAAIC,OAAO,GAAG;AACZX,YAAAA,SAAS,EAAEzB,OAAO,CAACC,GAAR,CAAYyB,0BADX;AAEZW,YAAAA,IAAI,EAAE;AACJT,cAAAA,MAAM,EAAEV,IAAI,CAACW,EADT;AAEJS,cAAAA,IAAI,EAAEf,OAAO,CAACe,IAFV;AAGJC,cAAAA,KAAK,EAAErB,IAAI,CAACqB,KAHR;AAIJC,cAAAA,KAAK,EAAEtB,IAAI,CAACsB;AAJR;AAFM,WAAd;AAUA,gBAAM5C,SAAS,CAAC6C,GAAV,CAAcL,OAAd,EAAuBJ,OAAvB,EAAN;AACD;AACF,OApBD,CAoBE,OAAOU,KAAP,EAAc;AACdvB,QAAAA,OAAO,CAACC,GAAR,CAAYsB,KAAK,CAACC,OAAlB;AACD;;AAED,aAAO,IAAP;AACD;;AA/BQ;AAbW,CAAD,CAAvB","sourcesContent":["import NextAuth from 'next-auth'\nimport { session } from 'next-auth/client'\nimport Providers from 'next-auth/providers'\nconst AWS = require('aws-sdk')\n\nconst docClient = new AWS.DynamoDB.DocumentClient({\n  region: process.env.NEXT_PUBLIC_AWS_REGION,\n  accessKeyId: process.env.NEXT_PUBLIC_AWS_ACCESS_KEY_ID,\n  secretAccessKey: process.env.NEXT_PUBLIC_AWS_SECRET_ACCESS_KEY,\n})\n\nexport default NextAuth({\n  // Configure one or more authentication providers\n  providers: [\n    Providers.Auth0({\n      clientId: process.env.NEXT_PUBLIC_AUTH0_CLIENT_ID,\n      clientSecret: process.env.NEXT_PUBLIC_AUTH0_CLIENT_SECRET,\n      domain: process.env.NEXT_PUBLIC_AUTH0_DOMAIN,\n    }),\n  ],\n  session: {\n    jwt: true,\n    maxAge: 1 * 60 * 60,\n  },\n  callbacks: {\n    async session(user, session) {\n      console.log('SESSION')\n      return session\n    },\n    async signIn(user, account, profile) {\n      try {\n        let params = {\n          TableName: process.env.NEXT_PUBLIC_DYNAMODB_TABLE,\n          Key: { userId: user.id },\n        }\n        const currentUser = await docClient.get(params).promise()\n\n        if (Object.keys(currentUser).length <= 0) {\n          let newUser = {\n            TableName: process.env.NEXT_PUBLIC_DYNAMODB_TABLE,\n            Item: {\n              userId: user.id,\n              name: profile.name,\n              email: user.email,\n              image: user.image,\n            },\n          }\n\n          await docClient.put(newUser).promise()\n        }\n      } catch (error) {\n        console.log(error.message)\n      }\n\n      return true\n    },\n  },\n})\n"]},"metadata":{},"sourceType":"module"}